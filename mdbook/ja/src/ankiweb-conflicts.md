# 同期で矛盾が生じた場合の処理

あまり起きるはずのないことですが、AnkiDroid上のデータを自動的にAnkiWeb上のデータと合成できないという場合があります。このような場合、矛盾が生じたデータについては、AnkiWebにアップロードするかAnkiWebからダウンロードするかを明示的に選ぶ必要があります。どちらを選んだ場合も、もう一方の側に元からあったデータは上書きされてしまいます。

また、もし同期する両方の側に新しいカードがあって、しかもどちらも消したくないような場合は、 [エクスポート(書き出し](exporting.md) を使った方法があります。まず先にAnkiDroidで新規カードの入っているデッキのエクスポートをしておき、それから同期して、「ダウンロード」を押してAnkiWebからダウンロードします(AnkiDroidのデータを上書きします)。同期が完了したら、先にエクスポートしておいたデッキをインポートすることができます。詳しくは [「インポート」の節](importing-anki-files.md) を参照してください。

## USB接続を使った同期

インターネットに接続できない場合でも、USB接続を使ってデッキを相互にコピーすることは可能です。

USB接続を使った方法では、全てのデッキを一度にまとめてインポート・エクスポートします。従って、AnkiWebを使った同期とは異なり、PCとAnkiDroidの両方でデッキを変更してその変更を合成する、といったことはできません。そうではなく、たとえばPC上で新しくカードを追加しようと思うなら、まず、モバイル端末上の最新の状態のデッキデータがPCにエクスポートされていることを確かめておかないといけません。そうでなければ、最後にPCにエクスポートした後で行なった学習や編集などに関する情報は、すべて消えてしまうことになります。

そこで、典型的な作業手順としては、まずモバイル端末のデータをエクスポートして、それをPCにインポートし、それからPCで何かの変更を行い、最後にデータを再びモバイル端末に戻す(PCからエクスポート、AnkiDroidでインポート)、というものになります。

なお、AnkiDroidは(訳注：Ankiと異なり)テキストファイルを直接インポートすることはできません。もしどうしてもそうしたければ、PC上で行ってからAnkiDroidにインポートする、という手順が必要になります。

### Ankiのすべてのデッキを、USB接続でAnkiDroidにコピーする

まずPCで次のように操作してください。

 1. Ankiを起動する
 2. メニューの、「ファイル」→「書き出す」を選ぶ
 3. 「書き出す...」ボタンをクリックする。このとき、「対象」が「全てのデッキ」になっていることを確認すること。AnkiDroidではデッキを個別にインポートすることはできない。また「スケジュール情報を含める」がチェックされていることも確認すること
 4. デスクトップにcollection.apkgというファイルが作成される。もし何か違う名前のようであれば、操作を間違えているので、前のステップに戻ること
 5. Android端末をUSBケーブルでPCに接続する
 6. PCのエクスプローラで、接続されたAndroid端末を開く
 7. AnkiDroidのフォルダを開く
 8. デスクトップのcollection.apkgを、開いたAnkiDroidフォルダにドラッグする

それから、AnkiDroidで次のように操作してください。

 1. デッキリスト画面で、メニューから「インポート」をタップする
 2. 「collection」を選択する

操作が完了すると、モバイル端末上のデッキは、すべてPCにあったもので置きかえられます。インポート機能についての詳しい説明は、 [「インポート」の節](importing-anki-files.md) を参照してください。

### AnkiDroidのすべてのデッキを、USB接続でAnkiにコピーする

AnkiDroidからAnkiにデッキをコピーする操作は、基本的には上と同様ですが、順番が逆になります。

 1. モバイル端末のUSB接続は外しておく
 2. AnkiDroidのデッキリスト画面で、メニューから「エクスポート(書き出し)」を選ぶ
 3. 「スケジュールを含める」がチェックされていることを確認して、「OK」ボタンを押す
 4. 端末をUSBケーブルでPCに接続する
 5. AnkiDroidで表示されたフォルダにある「collection.apkg」を、PCのデスクトップにコピーする
 6. PC上でcollection.apkgをダブルクリックし、Ankiにインポートする

AnkiDroidのエクスポート機能についてのさらに詳しい説明は、 [「エクスポート」の節](exporting.md) を参照してください。
